<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Nibras - Arabic Writing Sliding Puzzle</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Balsamiq+Sans:wght@700&family=Fredoka+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Lateef&family=Reem+Kufi&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Neue', cursive;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            width: 100%;
            border: 8px solid #ff6b6b;
        }

        .original-title {
            text-align: center;
            margin-bottom: 5px;
        }

        .original-title .arabic-name {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2.8em;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        .original-title .english-name {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2em;
            color: #7f8c8d;
            margin-top: -5px;
        }

        /* English Font Styles */
        .english {
            font-family: 'Comic Neue', cursive;
        }

        .english h1 {
            font-family: 'Fredoka One', cursive;
        }

        .english .subtitle {
            font-family: 'Balsamiq Sans', cursive;
        }

        .english .instructions h3 {
            font-family: 'Fredoka One', cursive;
        }

        .english .stat {
            font-family: 'Balsamiq Sans', cursive;
        }

        .english button {
            font-family: 'Fredoka One', cursive;
        }

        .english .current-challenge {
            font-family: 'Balsamiq Sans', cursive;
        }

        .english .educational-purpose h3 {
            font-family: 'Fredoka One', cursive;
        }

        .english .important-points h3 {
            font-family: 'Fredoka One', cursive;
        }

        /* Arabic Font Styles */
        .arabic {
            font-family: 'Lateef', serif;
            direction: rtl;
        }

        .arabic h1 {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 3.2em;
        }

        .arabic .subtitle {
            font-family: 'Amiri', serif;
            font-size: 1.6em;
        }

        .arabic .instructions h3 {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2em;
        }

        .arabic .instructions ul {
            font-size: 1.4em;
            line-height: 2.2;
        }

        .arabic .stat {
            font-family: 'Amiri', serif;
            font-size: 1.2em;
        }

        .arabic button {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 1.1em;
        }

        .arabic .current-challenge {
            font-family: 'Amiri', serif;
            font-size: 1.5em;
        }

        .arabic .educational-purpose h3 {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2em;
        }

        .arabic .educational-purpose p {
            font-size: 1.3em;
            line-height: 1.8;
        }

        .arabic .writing-area {
            font-size: 1.2em;
        }

        .arabic .important-points h3 {
            font-family: 'Reem Kufi', sans-serif;
            font-size: 2em;
        }

        .arabic .important-points ul {
            font-size: 1.3em;
            line-height: 2.0;
            text-align: right;
            padding-right: 20px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.8em;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 3px 3px 0px rgba(0,0,0,0.1);
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.4em;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .instructions {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            border: 4px dashed #e17055;
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .instructions h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.8em;
            text-align: center;
            background: linear-gradient(45deg, #e84393, #0984e3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .instructions ul {
            list-style-position: inside;
            line-height: 1.8;
            font-size: 1.2em;
        }

        .instructions li {
            margin-bottom: 10px;
            padding-left: 10px;
            font-weight: bold;
        }

        .instructions li:nth-child(1) { color: #e84393; }
        .instructions li:nth-child(2) { color: #0984e3; }
        .instructions li:nth-child(3) { color: #00b894; }
        .instructions li:nth-child(4) { color: #6c5ce7; }
        .instructions li:nth-child(5) { color: #636e72; }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #74b9ff, #a29bfe);
            border-radius: 15px;
            border: 4px solid #6c5ce7;
        }

        .stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 1.1em;
            border: 3px solid;
        }

        .stat:nth-child(1) {
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .stat:nth-child(2) {
            border-color: #4ecdc4;
            color: #4ecdc4;
        }

        .stat:nth-child(3) {
            border-color: #fdcb6e;
            color: #fdcb6e;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 25px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 6px 0 rgba(0,0,0,0.2);
            position: relative;
            top: 0;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 0 rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }

        #shuffleBtn {
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
            color: white;
            border: 3px solid #ff4757;
        }

        #resetBtn {
            background: linear-gradient(45deg, #74B9FF, #0984E3);
            color: white;
            border: 3px solid #0984e3;
        }

        #flipBtn {
            background: linear-gradient(45deg, #A29BFE, #6C5CE7);
            color: white;
            border: 3px solid #6c5ce7;
        }

        #nextChallenge {
            background: linear-gradient(45deg, #00B894, #55EFC4);
            color: white;
            border: 3px solid #00b894;
        }

        #soundToggle {
            background: linear-gradient(45deg, #FDCB6E, #FFEAA7);
            color: #2d3436;
            border: 3px solid #fdcb6e;
        }

        #languageToggle {
            background: linear-gradient(45deg, #FF9FF3, #F368E0);
            color: white;
            border: 3px solid #F368E0;
        }

        #colorToggle {
            background: linear-gradient(45deg, #FF9F1C, #FFBF69);
            color: white;
            border: 3px solid #FF9F1C;
        }

        #timerToggle {
            background: linear-gradient(45deg, #00cec9, #81ecec);
            color: white;
            border: 3px solid #00cec9;
        }

        .puzzle-area {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            align-items: flex-start;
        }

        .puzzle-container {
            position: relative;
        }

        .puzzle-board {
            display: grid;
            grid-template-columns: repeat(5, 70px);
            grid-template-rows: repeat(9, 70px);
            gap: 4px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            padding: 10px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            transition: transform 0.6s ease;
            border: 6px solid #ff9ff3;
        }

        .puzzle-board.flipped {
            transform: rotateY(180deg);
        }

        .reference-side {
            display: none;
            grid-template-columns: repeat(5, 70px);
            grid-template-rows: repeat(7, 70px);
            gap: 4px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            padding: 10px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            position: absolute;
            top: 70px;
            left: 0;
            width: 100%;
            height: calc(7 * 70px + 20px);
            transform: rotateY(180deg);
            backface-visibility: hidden;
            border: 6px solid #74b9ff;
        }

        .puzzle-board.flipped .reference-side {
            display: grid;
        }

        .puzzle-board.flipped .tile {
            visibility: hidden;
        }

        .tile {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.2);
            font-weight: bold;
            position: relative;
            backface-visibility: hidden;
            border: 3px solid;
        }

        .tile:hover {
            transform: scale(1.08);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            z-index: 10;
        }

        .hidden-tile {
            opacity: 0.3;
        }

        .bright-green {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            border-color: #219652;
        }

        .bright-blue {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-color: #21618c;
        }

        .bright-purple {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            border-color: #6c3483;
        }

        .bright-orange {
            background: linear-gradient(135deg, #e67e22, #d35400);
            border-color: #a04000;
        }

        .bright-pink {
            background: linear-gradient(135deg, #e84393, #fd79a8);
            border-color: #e84393;
        }

        .white-tile {
            background: linear-gradient(135deg, #ffffff, #f5f6fa);
            border-color: #e0e0e0;
        }

        .empty {
            background: transparent;
            border: 3px dashed #7f8c8d;
            cursor: default;
        }

        .empty:hover {
            transform: none;
            box-shadow: none;
        }

        .reference-cell {
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            border: 3px solid #e17055;
            font-size: 28px;
            font-weight: bold;
            color: #2d3436;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }

        .english .reference-cell {
            font-family: 'Fredoka One', cursive;
        }

        .arabic .reference-cell {
            font-family: 'Reem Kufi', sans-serif;
        }

        .reference-label {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            border: 3px solid #ff4757;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        .english .reference-label {
            font-family: 'Fredoka One', cursive;
        }

        .arabic .reference-label {
            font-family: 'Reem Kufi', sans-serif;
        }

        .challenge-info {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 4px solid #fdcb6e;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .challenge-info h4 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.6em;
            text-align: center;
            background: linear-gradient(45deg, #e84393, #0984e3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .current-challenge {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 12px;
            border: 3px dashed #74b9ff;
        }

        .writing-area {
            margin-top: 15px;
            text-align: center;
            color: #7f8c8d;
            font-size: 1.1em;
            font-weight: bold;
            background: linear-gradient(45deg, #74b9ff, #a29bfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .educational-purpose {
            text-align: center;
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border: 4px dashed #bdc3c7;
        }

        .educational-purpose h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.8em;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .educational-purpose p {
            font-size: 1.2em;
            line-height: 1.6;
            color: #666;
        }

        .important-points {
            text-align: center;
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border-radius: 15px;
            border: 4px dashed #28a745;
        }

        .important-points h3 {
            color: #155724;
            margin-bottom: 20px;
            font-size: 1.8em;
            background: linear-gradient(45deg, #28a745, #20c997);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .important-points ul {
            list-style-position: inside;
            line-height: 1.8;
            font-size: 1.1em;
            color: #155724;
            text-align: left;
        }

        .important-points li {
            margin-bottom: 12px;
            padding-left: 10px;
            font-weight: bold;
        }

        .copyright {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            border-radius: 15px;
            border: 3px solid #636e72;
            font-size: 0.9em;
            color: #2d3436;
        }

        .copyright .english {
            font-family: 'Comic Neue', cursive;
            margin-bottom: 10px;
        }

        .copyright .arabic {
            font-family: 'Lateef', serif;
            direction: rtl;
            font-size: 1.1em;
        }

        .color-key {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            font-size: 1.1em;
            flex-wrap: wrap;
        }

        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .sound-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
            background: #27ae60;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .sound-indicator.muted {
            background: #e74c3c;
        }

        .timer-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
            background: #00cec9;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .timer-indicator.stopped {
            background: #e74c3c;
        }

        .winning-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1000;
            font-size: 2em;
            font-weight: bold;
            border: 6px solid #ff4757;
            animation: celebrate 2s ease-in-out;
        }

        .pattern-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        /* Fun animations */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        .bounce {
            animation: bounce 1s;
        }

        @keyframes pulse {
            0% {transform: scale(1);}
            50% {transform: scale(1.05);}
            100% {transform: scale(1);}
        }

        .pulse {
            animation: pulse 0.5s;
        }

        @keyframes celebrate {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti 3s ease-in-out forwards;
            z-index: 999;
        }

        @media (max-width: 768px) {
            .puzzle-board {
                grid-template-columns: repeat(5, 50px);
                grid-template-rows: repeat(9, 50px);
            }
            
            .tile {
                width: 50px;
                height: 50px;
            }

            .reference-side {
                grid-template-columns: repeat(5, 50px);
                grid-template-rows: repeat(7, 50px);
                top: 50px;
                height: calc(7 * 50px + 20px);
            }

            .reference-cell {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 15px;
            }

            .controls {
                justify-content: center;
            }

            .puzzle-area {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }

            h1 {
                font-size: 2.2em;
            }

            .arabic h1 {
                font-size: 2.5em;
            }

            .original-title .arabic-name {
                font-size: 2.2em;
            }

            .instructions {
                padding: 20px;
            }

            .important-points {
                padding: 20px;
            }

            .important-points ul {
                font-size: 1em;
            }

            .winning-message {
                font-size: 1.5em;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container english" id="mainContainer">
        <!-- Original Arabic Name -->
        <div class="original-title">
            <div class="arabic-name">النّبراس</div>
            <div class="english-name">Al-Nibras (The Beacon)</div>
        </div>

        <h1 class="bounce">🎮 Arabic Writing Sliding Puzzle 🎮</h1>
        <div class="subtitle">5×9 Grid - Learn Arabic Letters & Numerals</div>
        
        <div class="instructions">
            <h3>🌟 How to Play: 🌟</h3>
            <ul>
                <li>🎯 Click any tile adjacent to the empty space to slide it</li>
                <li>📝 Form Arabic letters and numerals in 5×7 grid</li>
                <li>🔄 Use "Flip Puzzle" to see the reference patterns on the back</li>
                <li>🏆 Complete challenges by forming the correct patterns AND moving the empty space to row 1 or 9</li>
                <li>🌈 Change tile colors to suit your preferences!</li>
            </ul>
            <div class="color-key">
                <div><span class="color-sample" style="background: #27ae60;"></span> Colored Tiles (16)</div>
                <div><span class="color-sample" style="background: #ffffff;"></span> White Tiles (26)</div>
                <div><span class="color-sample" style="background: #27ae60; opacity: 0.3;"></span> Hidden Colored</div>
                <div><span class="color-sample" style="background: #ffffff; opacity: 0.3;"></span> Hidden White</div>
            </div>
        </div>

        <div class="game-info">
            <div class="stats">
                <div class="stat">
                    <strong>🎯 Moves:</strong> <span id="moveCounter">0</span>
                </div>
                <div class="stat">
                    <strong>⏱️ Time:</strong> <span id="timerDisplay">00:00</span>
                </div>
                <div class="stat">
                    <strong>🏆 Challenge:</strong> <span id="challengeCounter">ألف (Alif)</span>
                </div>
            </div>
            <div class="controls">
                <button id="shuffleBtn">🎲 Shuffle</button>
                <button id="resetBtn">🔄 Reset</button>
                <button id="flipBtn">📖 Flip Puzzle</button>
                <button id="nextChallenge">⭐ Next Challenge</button>
                <button id="colorToggle">🎨 Tile Color</button>
                <button id="timerToggle">⏱️ Timer: ON <span class="timer-indicator"></span></button>
                <button id="soundToggle">🔊 Sound: ON <span class="sound-indicator"></span></button>
                <button id="languageToggle">🌐 English / العربية</button>
            </div>
        </div>

        <div class="puzzle-area">
            <div class="puzzle-container">
                <div class="puzzle-board" id="puzzleBoard">
                    <!-- Puzzle tiles will be generated by JavaScript -->
                </div>
                <div class="reference-side" id="referenceSide">
                    <!-- Reference patterns will be generated by JavaScript -->
                </div>
            </div>
            
            <div class="challenge-info">
                <h4>🎯 Current Challenge:</h4>
                <div class="current-challenge" id="currentChallenge">Form the Arabic Letter 1 (Alif)</div>
                <p style="margin-top: 15px; color: #666;">
                    <strong>💡 Tip:</strong> Use the flip button to see the reference pattern on the back of the puzzle, just like the physical version! The empty space must be in row 1 or 9 to complete the challenge.
                </p>
            </div>
        </div>

        <div class="writing-area">
            <strong>📖 Reading Area:</strong> Middle 5×7 grid (Arabic letters and numerals are read in this clear area)
        </div>

        <div class="educational-purpose">
            <h3>🎓 Educational Purpose</h3>
            <p>This digital version mimics the physical sliding puzzle. Form Arabic letters (Challenge 1-29) and Arabic numerals (challenge 30-39) by sliding tiles, then flip to check against the reference patterns! Perfect for kids learning Arabic letters and numerals! 🎉</p>
            <p style="margin-top: 15px; font-style: italic;">
                <strong>Important Note:</strong> This game is based on the "Standard Script" developed by Professor Abdelmalek Bouhadjera in 1990 for writing Arabic with a detached script. This script takes into account the hamza and short vowel marks (Harakat) and allows for automated processing of the Arabic language.
            </p>
        </div>

        <!-- New Important Points Section -->
        <div class="important-points">
            <h3>📚 Important Points to Remember:</h3>
            <ul>
                <li>The Arabic alphabet has 29 letters, not 28.</li>
                <li>The number of consonants is 28, including the hamzat al-qata' (ء).</li>
                <li>The number of long vowels is 3 (ا, و, ي).</li>
                <li>The number of short vowels is 3 (Fatha, Damma and Ksra).</li>
                <li>The number of semi-vowels is 2 (و, ي).</li>
                <li>The auxiliary symbols for writing script are 3 (ه, ة, ي), and are not part of the alphabet.</li>
                <li>The short vowels are supposed to be part of the alphabet, but they are sometimes not written because Arabic is a derivational language.</li>
                <li>The shaddah (ّ) is extremely important because it indicates a doubled letter.</li>
            </ul>
        </div>

        <!-- Copyright Information -->
        <div class="copyright">
            <div class="english">
                © 1992 Original Game Design by Professor Abdelmalek Bouhadjera<br>
                Digital Version © 2024 - All Rights Reserved
            </div>
            <div class="arabic">
                © 1992 التصميم الأصلي للأستاذ الدكتور عبد المالك بوحجرة<br>
                النسخة الرقمية © 2024 - جميع الحقوق محفوظة
            </div>
        </div>
    </div>

    <script>
        // Character Patterns Lookup Table
        const characterPatterns = {
            // Arabic Letters (1-29)
            1: { // Alif - ا
                pattern: [
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0]
                ],
                name: { english: "Letter 1 (Alif)", arabic: "الحرف 1 (ألف)" },
                character: "ا",
                displayName: { english: "ألف (Alif)", arabic: "ألف" }
            },
            2: { // Ba - ب
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1],
                    [0,0,0,0,0],
                    [0,0,1,0,0]
                ],
                name: { english: "Letter 2 (Baa)", arabic: "الحرف 2 (باء)" },
                character: "ب",
                displayName: { english: "باء (Baa)", arabic: "باء" }
            },
            3: { // Ta - ت
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,0,1,0],
                    [0,0,0,0,0],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 3 (Taa)", arabic: "الحرف 3 (تاء)" },
                character: "ت",
                displayName: { english: "تاء (Taa)", arabic: "تاء" }
            },
            4: { // Tha - ث
                pattern: [
                    [0,0,0,0,0],
                    [0,0,1,0,0],
                    [0,1,0,1,0],
                    [0,0,0,0,0],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 4 (Thaa)", arabic: "الحرف 4 (ثاء)" },
                character: "ث",
                displayName: { english: "ثاء (Thaa)", arabic: "ثاء" }
            },
            5: { // Jeem - جيم
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,1,1,0,1]
                ],
                name: { english: "Letter 5 (Jeem)", arabic: "الحرف 5 (جيم)" },
                character: "جيم",
                displayName: { english: "جيم (Jeem)", arabic: "جيم" }
            },
            6: { // Haa - حاء
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 6 (Haa)", arabic: "الحرف 6 (حاء)" },
                character: "حاء",
                displayName: { english: "حاء (Haa)", arabic: "حاء" }
            },
            7: { // Khaa - خاء
                pattern: [
                    [0,0,0,1,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 7 (Khaa)", arabic: "الحرف 7(خاء)" },
                character: "خاء",
                displayName: { english: "خاء (Khaa)", arabic: "خاء" }
            },
            8: { // Daal - دال
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,0,0,0],
                    [0,1,1,1,1],
                    [0,0,0,0,1],
                    [0,1,1,1,1]
                ],
                name: { english: "Letter 8 (Daal)", arabic: "الحرف 8(دال)" },
                character: "دال",
                displayName: { english: "دال (Daal)", arabic: "دال" }
            },
            9: { // Dhaal - ذال
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,1],
                    [0,0,0,0,1],
                    [0,1,1,1,1]
                ],
                name: { english: "Letter 9 (Dhaal)", arabic: "الحرف 9(ذال)" },
                character: "ذال",
                displayName: { english: "ذال (Dhaal)", arabic: "ذال" }
            },
            10: { // Raa - راء
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 10 (Raa)", arabic: "الحرف 10(راء)" },
                character: "راء",
                displayName: { english: "راء (Raa)", arabic: "راء" }
            },
            11: { // Zay - زاي
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,1],
                    [0,0,0,0,0],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 11 (Zay)", arabic: "الحرف 11(زاي)" },
                character: "زاي",
                displayName: { english: "زاي (Zay)", arabic: "زاي" }
            },
            12: { // Seen - سين
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,0,1,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,0,0,0,0]
                ],
                name: { english: "Letter 12 (Seen)", arabic: "الحرف 12(سين)" },
                character: "سين",
                displayName: { english: "سين (Seen)", arabic: "سين" }
            },
            13: { // Sheen - شين
                pattern: [
                    [0,0,1,0,0],
                    [0,1,0,1,0],
                    [0,0,0,0,0],
                    [1,0,1,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,0,0,0,0]
                ],
                name: { english: "Letter 13 (Sheen)", arabic: "الحرف 13(شين)" },
                character: "شين",
                displayName: { english: "شين (Sheen)", arabic: "شين" }
            },
            14: { // Saad - صاد
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,1,1,1,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,0,0,0,0]
                ],
                name: { english: "Letter 14 (Saad)", arabic: "الحرف 14(صاد)" },
                character: "صاد",
                displayName: { english: "صاد (Saad)", arabic: "صاد" }
            },
            15: { // Daad - ضاد
                pattern: [
                    [0,0,1,0,0],
                    [0,0,0,0,0],
                    [1,1,1,1,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,0,0,0,0]
                ],
                name: { english: "Letter 15 (Daad)", arabic: "الحرف 15(ضاد)" },
                character: "ضاد",
                displayName: { english: "ضاد (Daad)", arabic: "ضاد" }
            },
            16: { // Taa - طاء
                pattern: [
                    [0,0,0,0,0],
                    [0,1,0,0,0],
                    [0,1,0,0,0],
                    [0,1,0,0,0],
                    [0,1,1,1,1],
                    [0,1,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 16 (Taa)", arabic: "الحرف 16(طاء)" },
                character: "طاء",
                displayName: { english: "طاء (Taa)", arabic: "طاء" }
            },
            17: { // Dhaa - ظاء
                pattern: [
                    [0,0,0,0,0],
                    [0,1,0,0,0],
                    [0,1,0,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,1],
                    [0,1,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 17 (Dhaa)", arabic: "الحرف 17(ظاء)" },
                character: "ظاء",
                displayName: { english: "ظاء (Dhaa)", arabic: "ظاء" }
            },
            18: { // Ayn - عين
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,1,0,0],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 18 (Ayn)", arabic: "الحرف 18(عين)" },
                character: "عين",
                displayName: { english: "عين (Ayn)", arabic: "عين" }
            },
            19: { // Ghayn - غين
                pattern: [
                    [0,0,0,1,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,1,0,0],
                    [1,1,1,1,1],
                    [1,0,0,0,0],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 19 (Ghayn)", arabic: "الحرف 19(غين)" },
                character: "غين",
                displayName: { english: "غين (Ghayn)", arabic: "غين" }
            },
            20: { // Faa - فاء
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,1,0],
                    [1,0,0,0,0],
                    [1,0,1,1,1],
                    [1,0,1,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 20 (Faa)", arabic: "الحرف 20(فاء)" },
                character: "فاء",
                displayName: { english: "فاء (Faa)", arabic: "فاء" }
            },
            21: { // Qaaf - قاف
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,0,1],
                    [1,0,0,0,0],
                    [1,0,1,1,1],
                    [1,0,1,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 21 (Qaaf)", arabic: "الحرف 21(قاف)" },
                character: "قاف",
                displayName: { english: "قاف (Qaaf)", arabic: "قاف" }
            },
            22: { // Kaaf - كاف
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,1],
                    [0,1,0,0,0],
                    [0,1,1,1,1],
                    [0,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 22 (Kaaf)", arabic: "الحرف 22(كاف)" },
                character: "كاف",
                displayName: { english: "كاف (Kaaf)", arabic: "كاف" }
            },
            23: { // Laam - لام
                pattern: [
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [0,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 23 (Laam)", arabic: "الحرف 23(لام)" },
                character: "لام",
                displayName: { english: "لام (Laam)", arabic: "لام" }
            },
            24: { // Meem - ميم
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [1,1,1,0,1],
                    [1,0,1,1,1],
                    [1,0,0,0,0],
                    [1,0,0,0,0]
                ],
                name: { english: "Letter 24 (Meem)", arabic: "الحرف 24(ميم)" },
                character: "ميم",
                displayName: { english: "ميم (Meem)", arabic: "ميم" }
            },
            25: { // Noon - نون
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Letter 25 (Noon)", arabic: "الحرف 25(نون)" },
                character: "نون",
                displayName: { english: "نون (Noon)", arabic: "نون" }
            },
            26: { // Haa - هاء
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,1,1,1,1],
                    [1,0,1,0,1],
                    [1,1,1,1,1],
                    [0,0,1,0,0],
                    [0,0,1,0,0]
                ],
                name: { english: "Letter 26 (Haa)", arabic: "الحرف 26(هاء)" },
                character: "هاء",
                displayName: { english: "هاء (Haa)", arabic: "هاء" }
            },
            27: { // Waw - واو
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,0,1,1,1],
                    [0,0,1,0,1],
                    [0,0,1,1,1],
                    [0,0,0,0,1],
                    [0,1,1,1,1]
                ],
                name: { english: "Letter 27 (Waw)", arabic: "الحرف 27(واو)" },
                character: "واو",
                displayName: { english: "واو (Waw)", arabic: "واو" }
            },
            28: { // Yaa - ياء
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [1,0,0,1,1],
                    [1,0,0,1,0],
                    [1,1,1,1,0],
                    [0,0,0,0,0],
                    [0,1,0,1,0]
                ],
                name: { english: "Letter 28 (Yaa)", arabic: "الحرف 28(ياء)" },
                character: "ياء",
                displayName: { english: "ياء (Yaa)", arabic: "ياء" }
            },
            29: { // Hamza - الهمزة
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0]
                ],
                name: { english: "Letter 29 (Hamza)", arabic: "الحرف 29(الهمزة)" },
                character: "الهمزة",
                displayName: { english: "الهمزة (Hamza)", arabic: "الهمزة" }
            },
            // Arabic Numerals (30-39)
            30: { // 0
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,1,0,1,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 0", arabic: "الرقم 0" },
                character: "0",
                displayName: { english: "صفر (Zero)", arabic: "صفر" }
            },
            31: { // 1
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,0,1,0,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 1", arabic: "الرقم 1" },
                character: "1",
                displayName: { english: "واحد (One)", arabic: "واحد" }
            },
            32: { // 2
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,0,0,1,0],
                    [0,1,1,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 2", arabic: "الرقم 2" },
                character: "2",
                displayName: { english: "اثنان (Two)", arabic: "اثنان" }
            },
            33: { // 3
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,0,0,1,0],
                    [0,0,1,1,0],
                    [0,0,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 3", arabic: "الرقم 3" },
                character: "3",
                displayName: { english: "ثلاثة (Three)", arabic: "ثلاثة" }
            },
            34: { // 4
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,0,0,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0],
                    [0,0,0,1,0],
                    [0,0,0,1,0]
                ],
                name: { english: "Numeral 4", arabic: "الرقم 4" },
                character: "4",
                displayName: { english: "أربعة (Four)", arabic: "أربعة" }
            },
            35: { // 5
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,0],
                    [0,0,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 5", arabic: "الرقم 5" },
                character: "5",
                displayName: { english: "خمسة (Five)", arabic: "خمسة" }
            },
            36: { // 6
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 6", arabic: "الرقم 6" },
                character: "6",
                displayName: { english: "ستة (Six)", arabic: "ستة" }
            },
            37: { // 7
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,0,0,1,0],
                    [0,0,0,1,0],
                    [0,0,0,1,0]
                ],
                name: { english: "Numeral 7", arabic: "الرقم 7" },
                character: "7",
                displayName: { english: "سبعة (Seven)", arabic: "سبعة" }
            },
            38: { // 8
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 8", arabic: "الرقم 8" },
                character: "8",
                displayName: { english: "ثمانية (Eight)", arabic: "ثمانية" }
            },
            39: { // 9
                pattern: [
                    [0,0,0,0,0],
                    [0,0,0,0,0],
                    [0,1,1,1,0],
                    [0,1,0,1,0],
                    [0,1,1,1,0],
                    [0,0,0,1,0],
                    [0,1,1,1,0]
                ],
                name: { english: "Numeral 9", arabic: "الرقم 9" },
                character: "9",
                displayName: { english: "تسعة (Nine)", arabic: "تسعة" }
            },
            // Default pattern for demonstration
            default: {
                pattern: [
                    [1,1,1,1,1],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,0,0,0,1],
                    [1,1,1,1,1]
                ],
                name: { english: "Demo Pattern", arabic: "النموذج التجريبي" },
                character: "◼",
                displayName: { english: "Demo Pattern", arabic: "النموذج التجريبي" }
            }
        };

        // Language content
        const translations = {
            english: {
                originalName: "Al-Nibras (The Beacon)",
                title: "🎮 Arabic Writing Sliding Puzzle 🎮",
                subtitle: "5×9 Grid - Learn Arabic Letters & Numerals",
                instructions: {
                    title: "🌟 How to Play: 🌟",
                    items: [
                        "🎯 Click any tile adjacent to the empty space to slide it",
                        "📝 Form Arabic letters and numerals in 5×7 grid",
                        "🔄 Use \"Flip Puzzle\" to see the reference patterns on the back",
                        "🏆 Complete challenges by forming the correct patterns AND moving the empty space to row 1 or 9",
                        "🌈 Change tile colors to suit your preferences!"
                    ]
                },
                buttons: {
                    shuffle: "🎲 Shuffle",
                    reset: "🔄 Reset",
                    flip: "📖 Flip Puzzle",
                    nextChallenge: "⭐ Next Challenge",
                    colorToggle: "🎨 Tile Color",
                    timerOn: "⏱️ Timer: ON",
                    timerOff: "⏱️ Timer: OFF",
                    soundOn: "🔊 Sound: ON",
                    soundOff: "🔇 Sound: OFF",
                    language: "🌐 English / العربية"
                },
                stats: {
                    moves: "🎯 Moves:",
                    time: "⏱️ Time:",
                    challenge: "🏆 Challenge:"
                },
                challenge: {
                    title: "🎯 Current Challenge:",
                    tip: "💡 Tip: Use the flip button to see the reference pattern on the back of the puzzle, just like the physical version! The empty space must be in row 1 or 9 to complete the challenge."
                },
                writingArea: "📖 Reading Area: Middle 5×7 grid (Arabic letters and numerals are read in this clear area)",
                educational: {
                    title: "🎓 Educational Purpose",
                    text: "This digital version mimics the physical sliding puzzle. Form Arabic letters (Challenge 1-29) and Arabic numerals (challenge 30-39) by sliding tiles, then flip to check against the reference patterns! Perfect for kids learning Arabic letters and numerals! 🎉",
                    note: "Important Note: This game is based on the \"Standard Script\" developed by Professor Abdelmalek Bouhadjera in 1990 for writing Arabic with a detached script. This script takes into account the hamza and short vowel marks (Harakat) and allows for automated processing of the Arabic language."
                },
                importantPoints: {
                    title: "📚 Important Points to Remember:",
                    items: [
                        "The Arabic alphabet has 29 letters, not 28.",
                        "The number of consonants is 28, including the hamzat al-qata' (ء).",
                        "The number of long vowels is 3 (ا, و, ي).",
                        "The number of short vowels is 3 (Fatha, Damma and Ksra).",
                        "The number of semi-vowels is 2 (و, ي).",
                        "The auxiliary symbols for writing script are 3 (ه, ة, ي), and are not part of the alphabet.",
                        "The short vowels are supposed to be part of the alphabet, but they are sometimes not written because Arabic is a derivational language.",
                        "The shaddah (ّ) is extremely important because it indicates a doubled letter."
                    ]
                },
                referenceLabel: "Reference Patterns",
                colorKey: ["Colored Tiles (16)", "White Tiles (26)", "Hidden Colored", "Hidden White"],
                copyright: {
                    english: "© 1992 Original Game Design by Professor Abdelmalek Bouhadjera<br>Digital Version © 2024 - All Rights Reserved",
                    arabic: "© 1992 التصميم الأصلي للأستاذ الدكتور عبد المالك بوحجرة<br>النسخة الرقمية © 2024 - جميع الحقوق محفوظة"
                },
                winningMessages: [
                    "🎉 Amazing! You formed the character perfectly! 🎉",
                    "🌟 Excellent work! Pattern matched! 🌟",
                    "🏆 Congratulations! Challenge completed! 🏆",
                    "✅ Perfect! You've mastered this character! ✅"
                ]
            },
            arabic: {
                originalName: "النّبراس (The Beacon)",
                title: "🎮 لغز الكتابة العربية المنزلق 🎮",
                subtitle: "شبكة 5×9 - تعلّم الحروف والأرقام العربية",
                instructions: {
                    title: "🌟 طريقة اللعب: 🌟",
                    items: [
                        "🎯 انقر على أي قطعة مجاورة للمساحة الفارغة لتحريكها",
                        "📝 شكّل الحروف والأرقام العربية في الشبكة 5×7",
                        "🔄 استخدم \"قلب اللغز\" لرؤية الأنماط المرجعية على الظهر",
                        "🏆 أكمل التحديات بتشكيل الأنماط الصحيحة ونقل المساحة الفارغة إلى الصف 1 أو 9",
                        "🌈 غيّر ألوان القطع لتتناسب مع ذوقك!"
                    ]
                },
                buttons: {
                    shuffle: "🎲 خلط",
                    reset: "🔄 إعادة",
                    flip: "📖 قلب اللغز",
                    nextChallenge: "⭐ التحدي التالي",
                    colorToggle: "🎨 لون القطع",
                    timerOn: "⏱️ المؤقت: تشغيل",
                    timerOff: "⏱️ المؤقت: إيقاف",
                    soundOn: "🔊 الصوت: تشغيل",
                    soundOff: "🔇 الصوت: إيقاف",
                    language: "🌐 العربية / English"
                },
                stats: {
                    moves: "🎯 الحركات:",
                    time: "⏱️ الوقت:",
                    challenge: "🏆 التحدي:"
                },
                challenge: {
                    title: "🎯 التحدي الحالي:",
                    tip: "💡 نصيحة: استخدم زر القلب لرؤية النمط المرجعي على ظهر اللغز، تماماً مثل النسخة المادية! يجب أن تكون المساحة الفارغة في الصف 1 أو 9 لإكمال التحدي."
                },
                writingArea: "📖 منطقة القراءة: الشبكة الوسطى 5×7 (تُقرأ الحروف والأرقام العربية في هذه المنطقة الواضحة)",
                educational: {
                    title: "🎓 الغرض التعليمي",
                    text: "هذه النسخة الرقمية تحاكي اللغز المنزلق المادي. شكّل الحروف العربية (التحدي 1-29) والأرقام العربية (التحدي 30-39) بتحريك القطع، ثم اقلب للتحقق من الأنماط المرجعية! مثالي للأطفال الذين يتعلمون الحروف والأرقام العربية! 🎉",
                    note: "ملاحظة هامة: هذه اللعبة مبنية على \"الخط المعياري\" الذي طوره الأستاذ عبد المالك بوحجرة في عام 1990 لكتابة العربية بخط منفصل. يأخذ هذا الخط في الاعتبار الهمزة وعلامات التشكيل (الحركات) ويسمح بالمعالجة الآلية للغة العربية."
                },
                importantPoints: {
                    title: "📚 نقاط مهمة يجب تذكرها:",
                    items: [
                        "الأبجدية العربية تحتوي على 29 حرفاً، وليس 28.",
                        "عدد الحروف الساكنة هو 28، بما في ذلك همزة القطع (ء).",
                        "عدد حروف المد (الحركات الطويلة) هو 3 (ا, و, ي).",
                        "عدد الحركات القصيرة هو 3 (الفتحة، الضمة، والكسرة).",
                        "عدد حروف العلة شبه الصوتية هو 2 (و, ي).",
                        "الرموز المساعدة للكتابة هي 3 (ه, ة, ي)، وهي ليست جزءاً من الأبجدية.",
                        "الحركات القصيرة من المفترض أن تكون جزءاً من الأبجدية، لكنها أحياناً لا تُكتب لأن العربية لغة اشتقاقية.",
                        "الشدة (ّ) مهمة جداً لأنها تشير إلى حرف مضعف."
                    ]
                },
                referenceLabel: "الأنماط المرجعية",
                colorKey: ["القطع الملونة (16)", "القطع البيضاء (26)", "الملون المخفي", "الأبيض المخفي"],
                copyright: {
                    english: "© 1992 Original Game Design by Professor Abdelmalek Bouhadjera<br>Digital Version © 2024 - All Rights Reserved",
                    arabic: "© 1992 التصميم الأصلي للأستاذ الدكتور عبد المالك بوحجرة<br>النسخة الرقمية © 2024 - جميع الحقوق محفوظة"
                },
                winningMessages: [
                    "🎉 مذهل! لقد شكلت الحرف بشكل مثالي! 🎉",
                    "🌟 عمل رائع! النمط متطابق! 🌟",
                    "🏆 تهانينا! اكتمل التحدي! 🏆",
                    "✅ ممتاز! لقد أتقنت هذا الحرف! ✅"
                ]
            }
        };

        class SoundManager {
            constructor() {
                this.enabled = true;
                console.log('SoundManager initialized');
            }

            createSlideSound() {
                try {
                    const context = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = context.createOscillator();
                    const gainNode = context.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(context.destination);
                    
                    oscillator.frequency.setValueAtTime(200, context.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(100, context.currentTime + 0.1);
                    
                    gainNode.gain.setValueAtTime(0.3, context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.1);
                    
                    oscillator.start(context.currentTime);
                    oscillator.stop(context.currentTime + 0.1);
                } catch (e) {
                    console.log('Sound error:', e);
                }
            }

            createClickSound() {
                try {
                    const context = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = context.createOscillator();
                    const gainNode = context.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(context.destination);
                    
                    oscillator.frequency.setValueAtTime(800, context.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, context.currentTime + 0.05);
                    
                    gainNode.gain.setValueAtTime(0.3, context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.05);
                    
                    oscillator.start(context.currentTime);
                    oscillator.stop(context.currentTime + 0.05);
                } catch (e) {
                    console.log('Sound error:', e);
                }
            }

            createWinSound() {
                try {
                    const context = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = context.createOscillator();
                    const gainNode = context.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(context.destination);
                    
                    // Victory sound - ascending scale
                    oscillator.frequency.setValueAtTime(262, context.currentTime); // C4
                    oscillator.frequency.setValueAtTime(330, context.currentTime + 0.1); // E4
                    oscillator.frequency.setValueAtTime(392, context.currentTime + 0.2); // G4
                    oscillator.frequency.setValueAtTime(523, context.currentTime + 0.3); // C5
                    
                    gainNode.gain.setValueAtTime(0.3, context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.5);
                    
                    oscillator.start(context.currentTime);
                    oscillator.stop(context.currentTime + 0.5);
                } catch (e) {
                    console.log('Sound error:', e);
                }
            }

            play(soundName) {
                if (!this.enabled) return;
                
                try {
                    switch(soundName) {
                        case 'slide':
                            this.createSlideSound();
                            break;
                        case 'click':
                            this.createClickSound();
                            break;
                        case 'win':
                            this.createWinSound();
                            break;
                    }
                } catch (error) {
                    console.log('Sound playback error:', error);
                }
            }

            toggle() {
                this.enabled = !this.enabled;
                const button = document.getElementById('soundToggle');
                
                if (this.enabled) {
                    button.innerHTML = translations[currentLanguage].buttons.soundOn + ' <span class="sound-indicator"></span>';
                    this.play('click');
                } else {
                    button.innerHTML = translations[currentLanguage].buttons.soundOff + ' <span class="sound-indicator muted"></span>';
                }
            }
        }

        class TimerManager {
            constructor() {
                this.enabled = true;
                this.isRunning = false;
                this.startTime = 0;
                this.elapsedTime = 0;
                this.intervalId = null;
                console.log('TimerManager initialized');
            }

            start() {
                if (!this.enabled || this.isRunning) return;
                
                this.isRunning = true;
                this.startTime = Date.now() - this.elapsedTime;
                this.intervalId = setInterval(() => {
                    this.updateDisplay();
                }, 1000);
                
                this.updateButton();
            }

            stop() {
                if (!this.isRunning) return;
                
                this.isRunning = false;
                this.elapsedTime = Date.now() - this.startTime;
                clearInterval(this.intervalId);
                this.updateButton();
            }

            reset() {
                this.stop();
                this.elapsedTime = 0;
                this.updateDisplay();
            }

            updateDisplay() {
                if (!this.isRunning) return;
                
                this.elapsedTime = Date.now() - this.startTime;
                const seconds = Math.floor(this.elapsedTime / 1000);
                const minutes = Math.floor(seconds / 60);
                const displaySeconds = seconds % 60;
                
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${displaySeconds.toString().padStart(2, '0')}`;
            }

            toggle() {
                this.enabled = !this.enabled;
                if (!this.enabled) {
                    this.stop();
                }
                this.updateButton();
            }

            updateButton() {
                const button = document.getElementById('timerToggle');
                const indicator = button.querySelector('.timer-indicator');
                
                if (this.enabled) {
                    button.innerHTML = translations[currentLanguage].buttons.timerOn + ' <span class="timer-indicator"></span>';
                    if (this.isRunning) {
                        indicator.style.background = '#00cec9';
                    } else {
                        indicator.style.background = '#fdcb6e';
                    }
                } else {
                    button.innerHTML = translations[currentLanguage].buttons.timerOff + ' <span class="timer-indicator stopped"></span>';
                }
            }

            getFormattedTime() {
                const seconds = Math.floor(this.elapsedTime / 1000);
                const minutes = Math.floor(seconds / 60);
                const displaySeconds = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${displaySeconds.toString().padStart(2, '0')}`;
            }
        }

        let currentLanguage = 'english';

        class SlidingPuzzle {
            constructor() {
                console.log('SlidingPuzzle constructor called');
                this.rows = 9;
                this.cols = 5;
                this.board = [];
                this.emptyPos = { row: 4, col: 2 }; // Empty space starts in the middle (row 5, index 4)
                this.moves = 0;
                this.isMoving = false;
                this.isFlipped = false;
                this.soundManager = new SoundManager();
                this.timerManager = new TimerManager();
                this.gameCompleted = false;
                this.firstMoveMade = false;
                
                // Color options for the tiles
                this.colorOptions = [
                    { name: 'Green', class: 'bright-green', sample: '#27ae60' },
                    { name: 'Blue', class: 'bright-blue', sample: '#3498db' },
                    { name: 'Purple', class: 'bright-purple', sample: '#9b59b6' }
                ];
                this.currentColorIndex = 0;
                
                // Challenges
                this.challenges = Object.keys(characterPatterns)
                    .filter(key => key !== 'default')
                    .map(key => ({
                        id: parseInt(key),
                        ...characterPatterns[key]
                    }));
                this.currentChallengeIndex = 0;
                
                this.resetToCheckerboard(); // Start with checkerboard pattern
                this.setupEventListeners();
                this.updateMoveCounter();
                this.updateChallengeDisplay();
                
                console.log('Puzzle initialized successfully');
            }

            get currentChallenge() {
                return this.challenges[this.currentChallengeIndex];
            }

            resetToCheckerboard() {
                this.soundManager.play('click');
                this.moves = 0;
                this.gameCompleted = false;
                this.firstMoveMade = false;
                this.timerManager.reset();
                this.emptyPos = { row: 4, col: 2 }; // Empty space starts in the middle (row 5, index 4)
                this.updateMoveCounter();
                
                // Reset the board with alternating pattern in 5×7 area
                this.board = [];
                
                // Counters to ensure exactly 16 colored tiles
                let coloredCount = 0;
                const maxColored = 16;
                
                // Create checkerboard pattern in the middle 7 rows (reading area)
                for (let row = 0; row < this.rows; row++) {
                    this.board[row] = [];
                    for (let col = 0; col < this.cols; col++) {
                        if (row === this.emptyPos.row && col === this.emptyPos.col) {
                            this.board[row][col] = null; // Empty space in the middle
                        } else if (row >= 1 && row <= 7) {
                            // Middle 7 rows - alternating pattern
                            const isColored = (row + col) % 2 === 0 && coloredCount < maxColored;
                            if (isColored) coloredCount++;
                            
                            this.board[row][col] = {
                                color: isColored ? this.colorOptions[this.currentColorIndex].class : 'white-tile',
                                isColored: isColored
                            };
                        } else {
                            // Top and bottom rows - white tiles
                            this.board[row][col] = {
                                color: 'white-tile',
                                isColored: false
                            };
                        }
                    }
                }
                
                // Ensure we have exactly 16 colored tiles by adjusting if needed
                if (coloredCount < maxColored) {
                    this.adjustColoredTiles(coloredCount, maxColored);
                }
                
                this.renderBoard();
            }

            adjustColoredTiles(currentCount, targetCount) {
                // Add more colored tiles if needed
                let needed = targetCount - currentCount;
                if (needed <= 0) return;
                
                // Find white tiles in the middle area that can be converted to colored
                const whitePositions = [];
                for (let row = 1; row <= 7; row++) {
                    for (let col = 0; col < this.cols; col++) {
                        if (this.board[row][col] && !this.board[row][col].isColored) {
                            whitePositions.push({ row, col });
                        }
                    }
                }
                
                // Randomly select white tiles to convert to colored
                whitePositions.sort(() => Math.random() - 0.5);
                for (let i = 0; i < Math.min(needed, whitePositions.length); i++) {
                    const pos = whitePositions[i];
                    this.board[pos.row][pos.col] = {
                        color: this.colorOptions[this.currentColorIndex].class,
                        isColored: true
                    };
                }
            }

            renderBoard() {
                const boardElement = document.getElementById('puzzleBoard');
                if (!boardElement) {
                    console.error('Puzzle board element not found!');
                    return;
                }
                
                boardElement.innerHTML = '';

                for (let row = 0; row < this.rows; row++) {
                    for (let col = 0; col < this.cols; col++) {
                        const tile = this.board[row][col];
                        const tileElement = document.createElement('div');
                        
                        if (tile === null) {
                            tileElement.className = 'tile empty';
                        } else {
                            tileElement.className = `tile ${tile.color}`;
                            if (row === 0 || row === 8) {
                                tileElement.classList.add('hidden-tile');
                            }
                            tileElement.addEventListener('click', () => this.handleTileClick(row, col));
                        }
                        
                        tileElement.dataset.row = row;
                        tileElement.dataset.col = col;
                        boardElement.appendChild(tileElement);
                    }
                }

                this.renderReferenceSide();
            }

            renderReferenceSide() {
                const referenceSide = document.getElementById('referenceSide');
                if (!referenceSide) return;
                
                referenceSide.innerHTML = '';

                // Add reference label
                const label = document.createElement('div');
                label.className = 'reference-label';
                label.textContent = translations[currentLanguage].referenceLabel;
                referenceSide.appendChild(label);

                // Get current pattern or use default
                const pattern = this.currentChallenge?.pattern || characterPatterns.default.pattern;
                
                // Add reference cells with pattern
                for (let row = 0; row < 7; row++) {
                    for (let col = 0; col < this.cols; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'reference-cell';
                        
                        if (pattern[row] && pattern[row][col] === 1) {
                            cell.style.background = 'linear-gradient(135deg, #2d3436, #636e72)';
                            cell.style.color = 'white';
                            cell.textContent = this.currentChallenge?.character || '◼';
                        }
                        
                        referenceSide.appendChild(cell);
                    }
                }
            }

            handleTileClick(row, col) {
                if (this.isMoving || this.isFlipped || this.gameCompleted) return;
                
                this.soundManager.play('click');
                
                // Start timer on first move
                if (!this.firstMoveMade) {
                    this.firstMoveMade = true;
                    this.timerManager.start();
                }
                
                if (this.canMove(row, col)) {
                    this.moveTile(row, col);
                }
            }

            canMove(row, col) {
                return (Math.abs(row - this.emptyPos.row) === 1 && col === this.emptyPos.col) || 
                       (Math.abs(col - this.emptyPos.col) === 1 && row === this.emptyPos.row);
            }

            moveTile(row, col) {
                if (this.isMoving) return;

                this.isMoving = true;
                this.soundManager.play('slide');
                
                // Swap tile with empty space
                this.board[this.emptyPos.row][this.emptyPos.col] = this.board[row][col];
                this.board[row][col] = null;
                this.emptyPos = { row, col };
                
                this.moves++;
                this.updateMoveCounter();
                
                setTimeout(() => {
                    this.renderBoard();
                    this.isMoving = false;
                    this.checkPattern();
                }, 150);
            }

            checkPattern() {
                if (this.gameCompleted) return;
                
                const pattern = this.currentChallenge.pattern;
                let patternMatched = true;
                
                // Check only the middle 7 rows (reading area)
                for (let row = 1; row <= 7; row++) {
                    for (let col = 0; col < this.cols; col++) {
                        const tile = this.board[row][col];
                        const shouldBeColored = pattern[row-1][col] === 1;
                        
                        if (shouldBeColored && (!tile || !tile.isColored)) {
                            patternMatched = false;
                            break;
                        } else if (!shouldBeColored && tile && tile.isColored) {
                            patternMatched = false;
                            break;
                        }
                    }
                    if (!patternMatched) break;
                }
                
                // Check if empty space is in row 1 or 9 (hidden rows)
                const emptyInHiddenRow = this.emptyPos.row === 0 || this.emptyPos.row === 8;
                
                if (patternMatched && emptyInHiddenRow) {
                    this.gameCompleted = true;
                    this.timerManager.stop();
                    this.showWinningMessage();
                }
            }

            showWinningMessage() {
                this.soundManager.play('win');
                
                // Create winning message
                const message = document.createElement('div');
                message.className = 'winning-message';
                const messages = translations[currentLanguage].winningMessages;
                message.textContent = messages[Math.floor(Math.random() * messages.length)];
                
                document.body.appendChild(message);
                
                // Create confetti effect
                this.createConfetti();
                
                // Remove message after 9 seconds
                setTimeout(() => {
                    message.remove();
                }, 9000);
            }

            createConfetti() {
                const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.animationDelay = Math.random() * 2 + 's';
                    document.body.appendChild(confetti);
                    
                    // Remove confetti after animation
                    setTimeout(() => confetti.remove(), 9000);
                }
            }

            shuffle() {
                this.soundManager.play('click');
                this.moves = 0;
                this.updateMoveCounter();
                this.gameCompleted = false;
                this.firstMoveMade = false;
                this.timerManager.reset();
                this.emptyPos = { row: 4, col: 2 }; // Empty space starts in the middle (row 5, index 4)
                
                // Create positions for all tiles (excluding empty space)
                const positions = [];
                for (let row = 0; row < this.rows; row++) {
                    for (let col = 0; col < this.cols; col++) {
                        if (!(row === this.emptyPos.row && col === this.emptyPos.col)) {
                            positions.push({ row, col });
                        }
                    }
                }
                
                // Shuffle positions for colored tiles (16 colored tiles)
                const shuffledPositions = [...positions].sort(() => Math.random() - 0.5);
                const coloredPositions = shuffledPositions.slice(0, 16);
                const whitePositions = shuffledPositions.slice(16);
                
                // Reset board
                this.board = [];
                for (let row = 0; row < this.rows; row++) {
                    this.board[row] = [];
                    for (let col = 0; col < this.cols; col++) {
                        if (row === this.emptyPos.row && col === this.emptyPos.col) {
                            this.board[row][col] = null;
                        } else {
                            this.board[row][col] = null;
                        }
                    }
                }
                
                // Place colored tiles
                coloredPositions.forEach(pos => {
                    this.board[pos.row][pos.col] = {
                        color: this.colorOptions[this.currentColorIndex].class,
                        isColored: true
                    };
                });
                
                // Place white tiles
                whitePositions.forEach(pos => {
                    this.board[pos.row][pos.col] = {
                        color: 'white-tile',
                        isColored: false
                    };
                });
                
                this.renderBoard();
            }

            flipPuzzle() {
                this.soundManager.play('click');
                const board = document.getElementById('puzzleBoard');
                this.isFlipped = !this.isFlipped;
                board.classList.toggle('flipped', this.isFlipped);
                
                const flipBtn = document.getElementById('flipBtn');
                if (this.isFlipped) {
                    flipBtn.textContent = currentLanguage === 'english' ? '📚 Show Puzzle' : '📚 عرض اللغز';
                } else {
                    flipBtn.textContent = currentLanguage === 'english' ? '📖 Flip Puzzle' : '📖 قلب اللغز';
                }
            }

            toggleColor() {
                this.soundManager.play('click');
                this.currentColorIndex = (this.currentColorIndex + 1) % this.colorOptions.length;
                // Reinitialize with current pattern but new color
                this.resetToCheckerboard();
            }

            nextChallenge() {
                this.soundManager.play('click');
                this.currentChallengeIndex = (this.currentChallengeIndex + 1) % this.challenges.length;
                this.moves = 0;
                this.gameCompleted = false;
                this.firstMoveMade = false;
                this.timerManager.reset();
                this.emptyPos = { row: 4, col: 2 }; // Empty space starts in the middle (row 5, index 4)
                this.updateMoveCounter();
                this.updateChallengeDisplay();
                this.resetToCheckerboard();
            }

            updateChallengeDisplay() {
                const challenge = this.currentChallenge;
                const displayText = currentLanguage === 'english' ? 
                    `Form the ${challenge.name.english}` : 
                    `شكّل ${challenge.name.arabic}`;
                
                document.getElementById('currentChallenge').textContent = displayText;
                
                // Update challenge counter with display name
                const challengeCounter = document.getElementById('challengeCounter');
                challengeCounter.textContent = currentLanguage === 'english' ? 
                    challenge.displayName.english : 
                    challenge.displayName.arabic;
            }

            updateMoveCounter() {
                document.getElementById('moveCounter').textContent = this.moves;
            }

            setupEventListeners() {
                // Add basic event listeners
                document.getElementById('shuffleBtn').addEventListener('click', () => this.shuffle());
                document.getElementById('resetBtn').addEventListener('click', () => this.resetToCheckerboard());
                document.getElementById('flipBtn').addEventListener('click', () => this.flipPuzzle());
                document.getElementById('nextChallenge').addEventListener('click', () => this.nextChallenge());
                document.getElementById('colorToggle').addEventListener('click', () => this.toggleColor());
                document.getElementById('timerToggle').addEventListener('click', () => this.timerManager.toggle());
                document.getElementById('soundToggle').addEventListener('click', () => this.soundManager.toggle());
                document.getElementById('languageToggle').addEventListener('click', () => this.toggleLanguage());

                console.log('Event listeners setup complete');
            }

            toggleLanguage() {
                currentLanguage = currentLanguage === 'english' ? 'arabic' : 'english';
                this.soundManager.play('click');
                this.updateInterfaceLanguage();
            }

            updateInterfaceLanguage() {
                const translation = translations[currentLanguage];
                
                // Update main elements
                document.querySelector('h1').textContent = translation.title;
                document.querySelector('.subtitle').textContent = translation.subtitle;
                
                // Update instructions
                const instructions = document.querySelector('.instructions');
                instructions.querySelector('h3').textContent = translation.instructions.title;
                const instructionItems = instructions.querySelectorAll('li');
                translation.instructions.items.forEach((item, index) => {
                    if (instructionItems[index]) {
                        instructionItems[index].textContent = item;
                    }
                });
                
                // Update color key
                const colorKeyItems = document.querySelectorAll('.color-key div');
                translation.colorKey.forEach((text, index) => {
                    if (colorKeyItems[index]) {
                        colorKeyItems[index].textContent = text;
                    }
                });
                
                // Update stats
                document.querySelector('.stat:nth-child(1) strong').textContent = translation.stats.moves;
                document.querySelector('.stat:nth-child(2) strong').textContent = translation.stats.time;
                document.querySelector('.stat:nth-child(3) strong').textContent = translation.stats.challenge;
                
                // Update buttons
                document.getElementById('shuffleBtn').textContent = translation.buttons.shuffle;
                document.getElementById('resetBtn').textContent = translation.buttons.reset;
                document.getElementById('flipBtn').textContent = this.isFlipped ? 
                    (currentLanguage === 'english' ? '📚 Show Puzzle' : '📚 عرض اللغز') : 
                    translation.buttons.flip;
                document.getElementById('nextChallenge').textContent = translation.buttons.nextChallenge;
                document.getElementById('colorToggle').textContent = translation.buttons.colorToggle;
                document.getElementById('timerToggle').innerHTML = this.timerManager.enabled ? 
                    translation.buttons.timerOn + ' <span class="timer-indicator"></span>' : 
                    translation.buttons.timerOff + ' <span class="timer-indicator stopped"></span>';
                document.getElementById('soundToggle').innerHTML = this.soundManager.enabled ? 
                    translation.buttons.soundOn + ' <span class="sound-indicator"></span>' : 
                    translation.buttons.soundOff + ' <span class="sound-indicator muted"></span>';
                document.getElementById('languageToggle').textContent = translation.buttons.language;
                
                // Update challenge info
                document.querySelector('.challenge-info h4').textContent = translation.challenge.title;
                document.querySelector('.challenge-info p strong').textContent = translation.challenge.tip;
                
                // Update writing area
                document.querySelector('.writing-area strong').textContent = translation.writingArea;
                
                // Update educational purpose
                const eduSection = document.querySelector('.educational-purpose');
                eduSection.querySelector('h3').textContent = translation.educational.title;
                const eduParagraphs = eduSection.querySelectorAll('p');
                eduParagraphs[0].textContent = translation.educational.text;
                eduParagraphs[1].innerHTML = `<strong>Important Note:</strong> ${translation.educational.note}`;
                
                // Update important points
                const importantPoints = document.querySelector('.important-points');
                importantPoints.querySelector('h3').textContent = translation.importantPoints.title;
                const importantItems = importantPoints.querySelectorAll('li');
                translation.importantPoints.items.forEach((item, index) => {
                    if (importantItems[index]) {
                        importantItems[index].textContent = item;
                    }
                });
                
                // Update reference label
                document.querySelector('.reference-label').textContent = translation.referenceLabel;
                
                // Update copyright
                document.querySelector('.copyright .english').innerHTML = translation.copyright.english;
                document.querySelector('.copyright .arabic').innerHTML = translation.copyright.arabic;
                
                // Update container class for RTL/LTR
                document.getElementById('mainContainer').className = `container ${currentLanguage}`;
                
                // Update challenge display
                this.updateChallengeDisplay();
                this.renderReferenceSide();
            }
        }

        // Initialize the game when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            console.log('DOM fully loaded, initializing game...');
            try {
                new SlidingPuzzle();
                console.log('Game initialized successfully!');
            } catch (error) {
                console.error('Error initializing game:', error);
            }
        });
    </script>
</body>
</html>
